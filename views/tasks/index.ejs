<%- include('../partials/header') %>
<%- include('../partials/nav') %>
<h2>Tasks Yaaa</h2>

<a href="/tasks/new">New Task</a>

<table id="list">
  <thead>
    <tr>
      <th></th>
      <th>Task Name</th>
      <th>Details</th>
      <th>Due Date</th>
      <th>Done</th>
      <th>Goal</th>
    </tr>
  </thead>
  <tbody>
    <% tasks.forEach(function(t) { %>
      <% console.log(t.done) %>
      <tr>
        <td>
          <form action="/tasks/isdone/<%= t._id %>?_method=PUT" method="POST">
          <input type="checkbox" name="done"
          <% if (t.done) { %>
          <%= ' checked ' %> 
          <% } %>
          onChange="this.form.submit()">
          </form>
        </td>
        <td><%= t.name %></td>
        <td><%= t.details %></td>
        <td><%= t.dueDate %></td>
        <td><%= t.done %></td>
        <td> <% if (t.goal) { %>
             <%= t.goal.name %>
            <% } %> </td>
        <td><a href="/tasks/<%= t._id %>/edit">Edit</a></td>
        <td>
          <form action="/tasks/<%= t._id %>?_method=DELETE" class="delete-form" method="POST">
            <button type="submit">Delete <%= t.name %></button>
          </form>
        </td>
      </tr>
      <% }); %>
    </tbody>
  </table>

<%- include('../partials/footer') %>